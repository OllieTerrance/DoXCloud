<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
        <title>DoX &ndash; Task management, your way.</title>
        <meta name="title" content="DoX"/>
        <meta name="description" content="Task management, your way."/>
        <meta name="author" content="Ollie Terrance"/>
        <link rel="icon" type="image/png" href="res/check.png"/>
        <link rel="shortcut icon" type="image/png" href="res/check.png"/>
        <link type="text/css" rel="stylesheet" href="http://fonts.googleapis.com/css?family=Open+Sans|Noto+Serif|Oxygen+Mono"/>
        <link type="text/css" rel="stylesheet" href="res/login.css"/>
        <script type="text/javascript" src="res/jquery-1.10.2.min.js"></script>
        <script type="text/javascript">
        function authSubmit(login) {
            if (!$("#authEmail").val()) {
                $("#infobar").html("<div class='infobar error'>You need to enter your email address.</div>");
                $("#authEmail").focus();
            } else if (!$("#authEmail").val().match(/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)) {
                $("#infobar").html("<div class='infobar error'>Your email address seems incorrect.</div>");
                $("#authEmail").focus();
            } else if (!$("#authPass").val()) {
                $("#infobar").html("<div class='infobar error'>You need to enter your password.</div>");
                $("#authPass").focus();
            } else if ($("#authPass").val().length < 4) {
                $("#infobar").html("<div class='infobar error'>Your password is too short &ndash; make it at least 4 characters.</div>");
                $("#authPass").focus();
            } else {
                $("#authForm input").attr("disabled", "disabled");
                $("#infobar").html("<div class='infobar'>Just a second...</div>");
                $.ajax({
                    url: "/api/auth.php",
                    dataType: "json",
                    method: "POST",
                    data: {
                        email: $("#authEmail").val(),
                        pass: $("#authPass").val(),
                        submit: login ? "login" : "register"
                    },
                    success: function(resp, status, obj) {
                        if (resp.success) {
                            $("#infobar").html("<div class='infobar success'>" + resp.success + "</div>");
                            $(location).attr("href", ".");
                        } else if (resp.error) {
                            $("#infobar").html("<div class='infobar error'>" + resp.error + "</div>");
                            $("#authForm input").removeAttr("disabled");
                            $("#authPass").focus();
                        } else {
                            $("#infobar").html("<div class='infobar error'>Oops, something went wrong there...</div>");
                            $("#authForm input").removeAttr("disabled");
                            $("#authEmail").focus();
                        }
                    },
                    error: function(obj, status, err) {
                        $("#infobar").html("<div class='infobar error'>Oops, something went wrong there...</div>");
                        $("#authForm input").removeAttr("disabled");
                        $("#authEmail").focus();
                    }
                });
            }
        }
        </script>
    </head>
    <body>
        <h1>DoX</h1>
        <h3>Task management, your way.</h3>
        <p>DoX (as in <strong>do &lt;X&gt;</strong>, where <strong>X</strong> is a task, but also pronouncable like &ldquo;docks&rdquo;) is a task management platform with a unique and readable data storage method.  It aims to be an extensive framework, providing the tools to manage tasks with descriptions, priorities, due dates, automatic repeat and tags.  <a href="about.html">Read more</a>.</p>
        <h2 id="start">Get started</h2>
        <h3>Login or register to start managing your tasks online.</h3>
        <span id="infobar"></span>
        <form id="authForm" novalidate onsubmit="return false;">
            <input id="authEmail" type="email" pattern="^(([^<>()[\]\\.,;:\s@\&quot;]+(\.[^<>()[\]\\.,;:\s@\&quot;]+)*)|(\&quot;.+\&quot;))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$" placeholder="Email address" required/>
            <input id="authPass" type="password" pattern=".{4,}" placeholder="Password" required/>
            <input id="authLogin" type="submit" value="Login" onclick="authSubmit(true);"/>
            <span style="display: inline-block; width: 25px; text-align: center;">or</span>
            <input id="authRegister" type="submit" value="Register" onclick="authSubmit(false);"/>
        </form>
        <div id="footer">
            <iframe src="http://ghbtns.com/github-btn.html?user=OllieTerrance&amp;repo=DoX&amp;type=watch&amp;size=large" style="width: 76px; height: 30px; border: 0;"></iframe>
            <span>&nbsp;&nbsp;&nbsp;</span>
            <iframe src="http://ghbtns.com/github-btn.html?user=OllieTerrance&amp;type=follow&amp;size=large" style="width: 215px; height: 30px; border: 0;"></iframe>
            <span>&nbsp;&nbsp;&nbsp;</span>
            <iframe src="https://platform.twitter.com/widgets/follow_button.1375828408.html#_=1376685971130&amp;id=twitter-widget-0&amp;lang=en&amp;screen_name=OllieTerrance&amp;show_count=false&amp;show_screen_name=true&amp;size=l" style="width: 185px; height: 29px; border: 0;"></iframe>
        </div>
    </body>
</html>